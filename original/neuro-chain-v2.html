<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neuro-Chain: Data-Driven Invention Graph</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=JetBrains+Mono:wght@300;400&display=swap');
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --bg-deep: #0a0a0f;
            --bg-surface: #12121a;
            --text-primary: #e8e6e3;
            --text-muted: #6b7280;
            --grid-line: rgba(255,255,255,0.03);
        }
        
        html, body { height: 100%; overflow: hidden; }
        
        body {
            font-family: 'JetBrains Mono', monospace;
            background: var(--bg-deep);
            color: var(--text-primary);
        }
        
        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background: 
                radial-gradient(ellipse 80% 50% at 50% 0%, rgba(255,107,53,0.06) 0%, transparent 50%),
                radial-gradient(ellipse 60% 40% at 80% 100%, rgba(157,78,221,0.05) 0%, transparent 40%),
                repeating-linear-gradient(0deg, transparent, transparent 100px, var(--grid-line) 100px, var(--grid-line) 101px),
                repeating-linear-gradient(90deg, transparent, transparent 100px, var(--grid-line) 100px, var(--grid-line) 101px);
            pointer-events: none;
        }
        
        #canvas-container { position: fixed; inset: 0; z-index: 1; }
        canvas { display: block; }
        
        .ui-layer { position: fixed; z-index: 10; pointer-events: none; }
        
        .title-block { top: 2rem; left: 2rem; pointer-events: auto; }
        
        .title-block h1 {
            font-family: 'Playfair Display', serif;
            font-size: 2.2rem;
            font-weight: 700;
            background: linear-gradient(135deg, #ff9f1c, #ff6b35);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .title-block .subtitle {
            font-size: 0.7rem;
            color: var(--text-muted);
            letter-spacing: 0.2em;
            text-transform: uppercase;
            margin-top: 0.3rem;
        }
        
        .legend {
            bottom: 2rem;
            left: 2rem;
            display: flex;
            flex-direction: column;
            gap: 0.4rem;
            pointer-events: auto;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.6rem;
            font-size: 0.65rem;
            color: var(--text-muted);
            cursor: pointer;
            transition: color 0.2s;
        }
        
        .legend-item:hover { color: var(--text-primary); }
        
        .legend-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            box-shadow: 0 0 8px currentColor;
        }
        
        .panel {
            top: 2rem;
            right: 2rem;
            bottom: 2rem;
            width: 400px;
            background: rgba(12,12,18,0.95);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 4px;
            backdrop-filter: blur(20px);
            display: flex;
            flex-direction: column;
            pointer-events: auto;
        }
        
        .panel-tabs {
            display: flex;
            border-bottom: 1px solid rgba(255,255,255,0.08);
        }
        
        .panel-tab {
            flex: 1;
            padding: 0.8rem;
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-muted);
            background: transparent;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .panel-tab:hover { color: var(--text-primary); }
        .panel-tab.active { 
            color: var(--text-primary); 
            background: rgba(255,255,255,0.03);
            border-bottom: 2px solid #ff6b35;
        }
        
        .panel-content {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
        }
        
        .panel-content::-webkit-scrollbar { width: 4px; }
        .panel-content::-webkit-scrollbar-track { background: transparent; }
        .panel-content::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 2px; }
        
        .tab-view { display: none; }
        .tab-view.active { display: block; }
        
        .cluster-section {
            margin-bottom: 1.5rem;
            opacity: 0;
            transform: translateY(8px);
            animation: fadeUp 0.3s ease forwards;
        }
        
        @keyframes fadeUp { to { opacity: 1; transform: translateY(0); } }
        
        .cluster-header {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.75rem;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            margin-bottom: 0.6rem;
        }
        
        .cluster-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }
        
        .cluster-body {
            font-size: 0.72rem;
            line-height: 1.7;
            color: var(--text-muted);
        }
        
        .cluster-body strong { color: var(--text-primary); font-weight: 400; }
        
        .link-tag {
            display: inline-block;
            font-size: 0.6rem;
            padding: 0.12rem 0.35rem;
            background: rgba(255,255,255,0.05);
            border-radius: 2px;
            margin: 0.2rem 0.2rem 0.2rem 0;
            color: var(--text-primary);
        }
        
        .link-tag.backlink {
            background: rgba(255,107,53,0.12);
            border: 1px solid rgba(255,107,53,0.25);
        }
        
        .json-editor {
            width: 100%;
            height: 100%;
            background: transparent;
            border: none;
            color: var(--text-primary);
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.68rem;
            line-height: 1.6;
            resize: none;
            outline: none;
        }
        
        .editor-toolbar {
            display: flex;
            gap: 0.5rem;
            padding: 0.75rem;
            border-bottom: 1px solid rgba(255,255,255,0.08);
        }
        
        .editor-btn {
            padding: 0.4rem 0.8rem;
            font-size: 0.65rem;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 3px;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .editor-btn:hover {
            background: rgba(255,255,255,0.08);
            color: var(--text-primary);
        }
        
        .editor-btn.primary {
            background: rgba(255,107,53,0.2);
            border-color: rgba(255,107,53,0.4);
            color: #ff6b35;
        }
        
        .editor-btn.primary:hover {
            background: rgba(255,107,53,0.3);
        }
        
        .status-bar {
            padding: 0.5rem 0.75rem;
            font-size: 0.6rem;
            color: var(--text-muted);
            border-top: 1px solid rgba(255,255,255,0.08);
            display: flex;
            justify-content: space-between;
        }
        
        .status-indicator {
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }
        
        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #2a9d8f;
        }
        
        .status-dot.error { background: #e63946; }
        
        .controls {
            bottom: 2rem;
            right: 420px;
            display: flex;
            gap: 0.4rem;
            pointer-events: auto;
        }
        
        .control-btn {
            width: 32px;
            height: 32px;
            background: rgba(12,12,18,0.9);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 3px;
            color: var(--text-muted);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            transition: all 0.2s;
        }
        
        .control-btn:hover {
            background: rgba(255,255,255,0.05);
            color: var(--text-primary);
        }
        
        .tooltip {
            position: fixed;
            background: rgba(12,12,18,0.95);
            border: 1px solid rgba(255,255,255,0.12);
            padding: 0.6rem 0.8rem;
            border-radius: 3px;
            font-size: 0.7rem;
            pointer-events: none;
            opacity: 0;
            transform: translateY(4px);
            transition: all 0.12s ease;
            max-width: 220px;
            z-index: 100;
            backdrop-filter: blur(10px);
        }
        
        .tooltip.visible { opacity: 1; transform: translateY(0); }
        
        .tooltip-title {
            font-family: 'Playfair Display', serif;
            font-size: 0.85rem;
            margin-bottom: 0.25rem;
        }
        
        .tooltip-meta {
            font-size: 0.6rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.08em;
        }
        
        .infinite-marker {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.6rem;
            color: var(--text-muted);
            letter-spacing: 0.25em;
            text-transform: uppercase;
            opacity: 0.4;
        }
        
        .data-selector {
            padding: 0.75rem;
            border-bottom: 1px solid rgba(255,255,255,0.08);
        }
        
        .data-selector select {
            width: 100%;
            padding: 0.5rem;
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 3px;
            color: var(--text-primary);
            font-family: inherit;
            font-size: 0.7rem;
            cursor: pointer;
        }
        
        .data-selector select:focus {
            outline: none;
            border-color: rgba(255,107,53,0.5);
        }
    </style>
</head>
<body>
    <div id="canvas-container">
        <canvas id="network"></canvas>
    </div>
    
    <div class="ui-layer title-block">
        <h1>Neuro-Chain</h1>
        <div class="subtitle">Data-Driven Invention Graph</div>
    </div>
    
    <div class="ui-layer legend" id="legend"></div>
    
    <div class="ui-layer panel">
        <div class="panel-tabs">
            <button class="panel-tab active" data-tab="clusters">Clusters</button>
            <button class="panel-tab" data-tab="editor">Data Editor</button>
        </div>
        
        <div class="tab-view active" id="tab-clusters">
            <div class="panel-content" id="cluster-content"></div>
        </div>
        
        <div class="tab-view" id="tab-editor">
            <div class="data-selector">
                <select id="data-select">
                    <option value="clusters">clusters.json</option>
                    <option value="nodes">nodes.json</option>
                    <option value="edges">edges.json</option>
                    <option value="descriptions">descriptions.json</option>
                </select>
            </div>
            <div class="editor-toolbar">
                <button class="editor-btn primary" id="apply-btn">Apply Changes</button>
                <button class="editor-btn" id="reset-btn">Reset</button>
                <button class="editor-btn" id="format-btn">Format</button>
            </div>
            <div class="panel-content">
                <textarea class="json-editor" id="json-editor" spellcheck="false"></textarea>
            </div>
            <div class="status-bar">
                <div class="status-indicator">
                    <span class="status-dot" id="status-dot"></span>
                    <span id="status-text">Valid JSON</span>
                </div>
                <span id="node-count">0 nodes</span>
            </div>
        </div>
    </div>
    
    <div class="ui-layer controls">
        <button class="control-btn" id="resetView" title="Reset View">⟲</button>
        <button class="control-btn" id="toggleAnim" title="Pause">⏸</button>
        <button class="control-btn" id="exportData" title="Export">↓</button>
    </div>
    
    <div class="tooltip" id="tooltip">
        <div class="tooltip-title"></div>
        <div class="tooltip-meta"></div>
    </div>
    
    <div class="infinite-marker">∞ Open-Ended Network ∞</div>

    <script>
    const DATA = {
        clusters: {
            "fire": { "color": "#ff6b35", "label": "Fire Cluster" },
            "energy": { "color": "#e63946", "label": "Energy Systems" },
            "tools": { "color": "#f4a261", "label": "Tool Chain" },
            "bio": { "color": "#2a9d8f", "label": "Biological" },
            "info": { "color": "#4cc9f0", "label": "Information" },
            "agi": { "color": "#9d4edd", "label": "AGI Hub" },
            "materials": { "color": "#94a3b8", "label": "Materials" },
            "social": { "color": "#f472b6", "label": "Social Systems" },
            "space": { "color": "#22d3d3", "label": "Space & Scale" }
        },
        
        nodes: [
            { "id": "fire", "label": "Fire", "cluster": "fire", "x": 0, "y": 0, "size": 28 },
            { "id": "cooking", "label": "Cooking", "cluster": "fire", "x": -80, "y": -100, "size": 16 },
            { "id": "warmth", "label": "Warmth", "cluster": "fire", "x": 100, "y": -60, "size": 14 },
            { "id": "light", "label": "Light", "cluster": "fire", "x": 60, "y": 80, "size": 14 },
            { "id": "ceramics", "label": "Ceramics", "cluster": "fire", "x": -100, "y": 60, "size": 15 },
            { "id": "metallurgy", "label": "Metallurgy", "cluster": "fire", "x": -40, "y": 140, "size": 22 },
            { "id": "charcoal", "label": "Charcoal", "cluster": "fire", "x": -140, "y": 120, "size": 12 },
            { "id": "glass", "label": "Glass", "cluster": "fire", "x": -160, "y": 20, "size": 13 },
            
            { "id": "stone-tools", "label": "Stone Tools", "cluster": "tools", "x": -280, "y": -60, "size": 18 },
            { "id": "cutting", "label": "Cutting", "cluster": "tools", "x": -350, "y": -130, "size": 12 },
            { "id": "hammers", "label": "Hammers", "cluster": "tools", "x": -360, "y": 10, "size": 12 },
            { "id": "chisels", "label": "Chisels", "cluster": "tools", "x": -400, "y": 80, "size": 11 },
            { "id": "lathe", "label": "Lathe", "cluster": "tools", "x": -320, "y": 160, "size": 17 },
            { "id": "precision", "label": "Precision", "cluster": "tools", "x": -380, "y": 240, "size": 15 },
            { "id": "machine-tools", "label": "Machine Tools", "cluster": "tools", "x": -260, "y": 280, "size": 17 },
            { "id": "robotics", "label": "Robotics", "cluster": "tools", "x": -200, "y": 350, "size": 16 },
            { "id": "3d-printing", "label": "3D Printing", "cluster": "tools", "x": -300, "y": 360, "size": 14 },
            
            { "id": "steam", "label": "Steam Engine", "cluster": "energy", "x": 150, "y": 200, "size": 18 },
            { "id": "electricity", "label": "Electricity", "cluster": "energy", "x": 240, "y": 120, "size": 24 },
            { "id": "grid", "label": "Power Grid", "cluster": "energy", "x": 320, "y": 200, "size": 16 },
            { "id": "combustion", "label": "Combustion", "cluster": "energy", "x": 180, "y": 300, "size": 16 },
            { "id": "nuclear", "label": "Nuclear", "cluster": "energy", "x": 340, "y": 300, "size": 18 },
            { "id": "solar", "label": "Solar", "cluster": "energy", "x": 400, "y": 240, "size": 15 },
            { "id": "fusion", "label": "Fusion", "cluster": "energy", "x": 420, "y": 340, "size": 14 },
            { "id": "batteries", "label": "Batteries", "cluster": "energy", "x": 280, "y": 40, "size": 14 },
            
            { "id": "agriculture", "label": "Agriculture", "cluster": "bio", "x": -160, "y": -220, "size": 18 },
            { "id": "breeding", "label": "Selective Breeding", "cluster": "bio", "x": -240, "y": -300, "size": 13 },
            { "id": "fermentation", "label": "Fermentation", "cluster": "bio", "x": -60, "y": -200, "size": 12 },
            { "id": "medicine", "label": "Medicine", "cluster": "bio", "x": 40, "y": -240, "size": 17 },
            { "id": "genetics", "label": "Genetics", "cluster": "bio", "x": -120, "y": -340, "size": 16 },
            { "id": "crispr", "label": "CRISPR", "cluster": "bio", "x": -40, "y": -400, "size": 15 },
            { "id": "synbio", "label": "Synthetic Biology", "cluster": "bio", "x": 60, "y": -360, "size": 14 },
            { "id": "neural-interface", "label": "Neural Interfaces", "cluster": "bio", "x": 160, "y": -320, "size": 15 },
            { "id": "antibiotics", "label": "Antibiotics", "cluster": "bio", "x": 120, "y": -240, "size": 13 },
            { "id": "vaccines", "label": "Vaccines", "cluster": "bio", "x": 180, "y": -180, "size": 13 },
            
            { "id": "language", "label": "Language", "cluster": "info", "x": 300, "y": -160, "size": 18 },
            { "id": "writing", "label": "Writing", "cluster": "info", "x": 380, "y": -100, "size": 17 },
            { "id": "printing", "label": "Printing", "cluster": "info", "x": 450, "y": -40, "size": 16 },
            { "id": "telegraph", "label": "Telegraph", "cluster": "info", "x": 400, "y": 60, "size": 14 },
            { "id": "computing", "label": "Computing", "cluster": "info", "x": 480, "y": 140, "size": 22 },
            { "id": "transistor", "label": "Transistor", "cluster": "info", "x": 540, "y": 60, "size": 20 },
            { "id": "internet", "label": "Internet", "cluster": "info", "x": 560, "y": 200, "size": 20 },
            { "id": "ml", "label": "Machine Learning", "cluster": "info", "x": 520, "y": 280, "size": 18 },
            { "id": "blockchain", "label": "Blockchain", "cluster": "info", "x": 600, "y": 140, "size": 12 },
            { "id": "cryptography", "label": "Cryptography", "cluster": "info", "x": 540, "y": -20, "size": 13 },
            
            { "id": "bronze", "label": "Bronze", "cluster": "materials", "x": -60, "y": 220, "size": 14 },
            { "id": "iron", "label": "Iron", "cluster": "materials", "x": 20, "y": 260, "size": 15 },
            { "id": "steel", "label": "Steel", "cluster": "materials", "x": 80, "y": 320, "size": 16 },
            { "id": "concrete", "label": "Concrete", "cluster": "materials", "x": -20, "y": 340, "size": 14 },
            { "id": "plastics", "label": "Plastics", "cluster": "materials", "x": 40, "y": 400, "size": 15 },
            { "id": "semiconductors", "label": "Semiconductors", "cluster": "materials", "x": 140, "y": 380, "size": 17 },
            { "id": "graphene", "label": "Graphene", "cluster": "materials", "x": 100, "y": 460, "size": 12 },
            { "id": "metamaterials", "label": "Metamaterials", "cluster": "materials", "x": 200, "y": 440, "size": 11 },
            
            { "id": "writing-social", "label": "Record Keeping", "cluster": "social", "x": 260, "y": -280, "size": 13 },
            { "id": "money", "label": "Money", "cluster": "social", "x": 340, "y": -240, "size": 16 },
            { "id": "markets", "label": "Markets", "cluster": "social", "x": 420, "y": -200, "size": 14 },
            { "id": "corporations", "label": "Corporations", "cluster": "social", "x": 480, "y": -140, "size": 13 },
            { "id": "democracy", "label": "Democracy", "cluster": "social", "x": 200, "y": -340, "size": 14 },
            { "id": "law", "label": "Legal Systems", "cluster": "social", "x": 280, "y": -380, "size": 13 },
            { "id": "universities", "label": "Universities", "cluster": "social", "x": 360, "y": -320, "size": 14 },
            
            { "id": "telescope", "label": "Telescope", "cluster": "space", "x": -220, "y": -400, "size": 14 },
            { "id": "microscope", "label": "Microscope", "cluster": "space", "x": -300, "y": -360, "size": 14 },
            { "id": "rocketry", "label": "Rocketry", "cluster": "space", "x": -380, "y": -420, "size": 15 },
            { "id": "satellites", "label": "Satellites", "cluster": "space", "x": -440, "y": -360, "size": 14 },
            { "id": "gps", "label": "GPS", "cluster": "space", "x": -500, "y": -300, "size": 13 },
            { "id": "space-stations", "label": "Space Stations", "cluster": "space", "x": -460, "y": -440, "size": 12 },
            
            { "id": "agi", "label": "AGI", "cluster": "agi", "x": 440, "y": 400, "size": 32 },
            { "id": "quantum-computing", "label": "Quantum Computing", "cluster": "agi", "x": 360, "y": 460, "size": 16 },
            { "id": "neuromorphic", "label": "Neuromorphic", "cluster": "agi", "x": 520, "y": 440, "size": 14 },
            { "id": "unknown-1", "label": "?", "cluster": "agi", "x": 580, "y": 480, "size": 11 },
            { "id": "unknown-2", "label": "?", "cluster": "agi", "x": 500, "y": 520, "size": 11 },
            { "id": "infinity", "label": "∞", "cluster": "agi", "x": 440, "y": 540, "size": 10 }
        ],
        
        edges: [
            { "source": "fire", "target": "cooking", "type": "forward" },
            { "source": "fire", "target": "warmth", "type": "forward" },
            { "source": "fire", "target": "light", "type": "forward" },
            { "source": "fire", "target": "ceramics", "type": "forward" },
            { "source": "fire", "target": "metallurgy", "type": "forward" },
            { "source": "fire", "target": "charcoal", "type": "forward" },
            { "source": "fire", "target": "glass", "type": "forward" },
            { "source": "stone-tools", "target": "fire", "type": "backlink" },
            { "source": "ceramics", "target": "metallurgy", "type": "forward" },
            { "source": "charcoal", "target": "metallurgy", "type": "forward" },
            
            { "source": "stone-tools", "target": "cutting", "type": "forward" },
            { "source": "stone-tools", "target": "hammers", "type": "forward" },
            { "source": "hammers", "target": "metallurgy", "type": "forward" },
            { "source": "hammers", "target": "chisels", "type": "forward" },
            { "source": "chisels", "target": "lathe", "type": "forward" },
            { "source": "lathe", "target": "precision", "type": "forward" },
            { "source": "lathe", "target": "machine-tools", "type": "forward" },
            { "source": "precision", "target": "machine-tools", "type": "forward" },
            { "source": "machine-tools", "target": "robotics", "type": "forward" },
            { "source": "machine-tools", "target": "3d-printing", "type": "forward" },
            { "source": "precision", "target": "transistor", "type": "forward" },
            
            { "source": "metallurgy", "target": "steam", "type": "forward" },
            { "source": "steam", "target": "electricity", "type": "forward" },
            { "source": "electricity", "target": "grid", "type": "forward" },
            { "source": "electricity", "target": "batteries", "type": "forward" },
            { "source": "steam", "target": "combustion", "type": "forward" },
            { "source": "grid", "target": "nuclear", "type": "forward" },
            { "source": "grid", "target": "solar", "type": "forward" },
            { "source": "nuclear", "target": "fusion", "type": "forward" },
            { "source": "electricity", "target": "computing", "type": "forward" },
            
            { "source": "cooking", "target": "agriculture", "type": "forward" },
            { "source": "cutting", "target": "agriculture", "type": "forward" },
            { "source": "agriculture", "target": "breeding", "type": "forward" },
            { "source": "agriculture", "target": "fermentation", "type": "forward" },
            { "source": "fermentation", "target": "medicine", "type": "forward" },
            { "source": "breeding", "target": "genetics", "type": "forward" },
            { "source": "genetics", "target": "crispr", "type": "forward" },
            { "source": "crispr", "target": "synbio", "type": "forward" },
            { "source": "medicine", "target": "antibiotics", "type": "forward" },
            { "source": "medicine", "target": "vaccines", "type": "forward" },
            { "source": "synbio", "target": "neural-interface", "type": "forward" },
            { "source": "glass", "target": "microscope", "type": "forward" },
            { "source": "microscope", "target": "medicine", "type": "backlink" },
            
            { "source": "language", "target": "writing", "type": "forward" },
            { "source": "writing", "target": "printing", "type": "forward" },
            { "source": "printing", "target": "telegraph", "type": "forward" },
            { "source": "electricity", "target": "telegraph", "type": "forward" },
            { "source": "telegraph", "target": "computing", "type": "forward" },
            { "source": "transistor", "target": "computing", "type": "forward" },
            { "source": "computing", "target": "internet", "type": "forward" },
            { "source": "internet", "target": "ml", "type": "forward" },
            { "source": "computing", "target": "cryptography", "type": "forward" },
            { "source": "cryptography", "target": "blockchain", "type": "forward" },
            
            { "source": "metallurgy", "target": "bronze", "type": "forward" },
            { "source": "bronze", "target": "iron", "type": "forward" },
            { "source": "iron", "target": "steel", "type": "forward" },
            { "source": "steel", "target": "concrete", "type": "forward" },
            { "source": "steel", "target": "plastics", "type": "forward" },
            { "source": "plastics", "target": "semiconductors", "type": "forward" },
            { "source": "semiconductors", "target": "transistor", "type": "backlink" },
            { "source": "semiconductors", "target": "graphene", "type": "forward" },
            { "source": "graphene", "target": "metamaterials", "type": "forward" },
            
            { "source": "writing", "target": "writing-social", "type": "forward" },
            { "source": "writing-social", "target": "money", "type": "forward" },
            { "source": "money", "target": "markets", "type": "forward" },
            { "source": "markets", "target": "corporations", "type": "forward" },
            { "source": "writing-social", "target": "democracy", "type": "forward" },
            { "source": "democracy", "target": "law", "type": "forward" },
            { "source": "law", "target": "universities", "type": "forward" },
            { "source": "universities", "target": "genetics", "type": "backlink" },
            
            { "source": "glass", "target": "telescope", "type": "forward" },
            { "source": "telescope", "target": "rocketry", "type": "forward" },
            { "source": "combustion", "target": "rocketry", "type": "forward" },
            { "source": "rocketry", "target": "satellites", "type": "forward" },
            { "source": "satellites", "target": "gps", "type": "forward" },
            { "source": "satellites", "target": "space-stations", "type": "forward" },
            { "source": "gps", "target": "internet", "type": "backlink" },
            
            { "source": "ml", "target": "agi", "type": "forward" },
            { "source": "neural-interface", "target": "agi", "type": "forward" },
            { "source": "synbio", "target": "agi", "type": "forward" },
            { "source": "computing", "target": "quantum-computing", "type": "forward" },
            { "source": "quantum-computing", "target": "agi", "type": "forward" },
            { "source": "semiconductors", "target": "neuromorphic", "type": "forward" },
            { "source": "neuromorphic", "target": "agi", "type": "forward" },
            { "source": "grid", "target": "agi", "type": "forward" },
            { "source": "robotics", "target": "agi", "type": "forward" },
            { "source": "agi", "target": "unknown-1", "type": "forward" },
            { "source": "agi", "target": "unknown-2", "type": "forward" },
            { "source": "agi", "target": "infinity", "type": "forward" }
        ],
        
        descriptions: {
            "fire": {
                "title": "Fire Cluster — The Primordial Hub",
                "body": "<strong>Fire</strong> emerges not as beginning but as the first <em>high-connectivity node</em>—a natural phenomenon captured and sustained. Constraint profile: <strong>oxygen, fuel, ignition energy</strong>.<br><br>Fire immediately spawns parallel chains: <strong>cooking</strong> (biology fork—caloric density enables brain expansion), <strong>warmth</strong> (habitat expansion), <strong>light</strong> (temporal liberation), <strong>material transformation</strong> (ceramics, glass, metallurgy).",
                "links": ["→ Metallurgy", "→ Cooking", "→ Glass"],
                "backlinks": ["← Stone Tools (friction)"]
            },
            "energy": {
                "title": "Energy Systems — Constraint Cascade",
                "body": "Fire's offspring: <strong>steam</strong> (fire + water containment), <strong>combustion</strong> (fire + mechanical precision + refined fuel), <strong>electricity</strong> (magnetism + motion + conductive materials).<br><br>Each step multiplies constraints: steam requires <strong>metallurgy for pressure vessels</strong>; electricity requires <strong>copper mining, rubber insulation, magnetic theory</strong>. Energy density becomes the master constraint.",
                "links": ["→ Grid", "→ Computing", "→ Fusion"],
                "backlinks": ["← Fire", "← Metallurgy"]
            },
            "tools": {
                "title": "Tool Chain — Recursive Self-Improvement",
                "body": "<strong>Stone tools</strong> predate fire—the first manufactured edges. Tools make tools: <strong>hammers shape chisels, chisels shape dies, dies stamp precision parts</strong>.<br><br>The <strong>lathe</strong> is a phase transition: round symmetry enables bearings, shafts, threads. <strong>Machine tools</strong> hit self-replication: machines that build machines.",
                "links": ["→ Robotics", "→ 3D Printing", "→ Precision"],
                "backlinks": ["← Metallurgy", "← Fire (hardening)"]
            },
            "bio": {
                "title": "Biological Chain — Wet Substrate",
                "body": "<strong>Agriculture</strong> emerges from observation + seasonal memory + seed storage. Constraint: <strong>arable land, water, labor</strong>. Spawns <strong>irrigation, selective breeding, fermentation</strong>.<br><br><strong>Medicine</strong> branches: herbalism → chemistry → germ theory → antibiotics → gene editing. <strong>CRISPR</strong> loops back to information cluster (DNA as code).",
                "links": ["→ CRISPR", "→ Neural Interfaces", "→ Synbio"],
                "backlinks": ["← Fire (cooking)", "← Microscopy", "← Universities"]
            },
            "info": {
                "title": "Information Chain — Pattern Persistence",
                "body": "<strong>Language</strong> is the substrate—symbols externalize cognition. <strong>Writing</strong> decouples information from biological memory. <strong>Printing</strong> enables mass replication; <strong>telegraph</strong> breaks distance constraint.<br><br><strong>Transistor</strong> is a mega-hub: spawns all digital technology. Constraint cascade: <strong>silicon purity, photolithography precision, quantum tunneling limits</strong>.",
                "links": ["→ AGI", "→ Internet", "→ Quantum Computing"],
                "backlinks": ["← Electricity", "← Precision tools", "← Semiconductors"]
            },
            "materials": {
                "title": "Materials Chain — Atomic Architecture",
                "body": "Metallurgy spawns the <strong>age cascade</strong>: bronze → iron → steel. Each material unlocks new constraint envelopes: <strong>temperature tolerance, tensile strength, conductivity</strong>.<br><br><strong>Semiconductors</strong> become the bridge to information: doped silicon enables transistors. <strong>Graphene and metamaterials</strong> hint at programmable matter.",
                "links": ["→ Semiconductors", "→ Graphene", "→ Metamaterials"],
                "backlinks": ["← Fire", "← Chemistry"]
            },
            "social": {
                "title": "Social Systems — Coordination Protocols",
                "body": "<strong>Writing</strong> enables record-keeping → accounting → money → markets. <strong>Coordination at scale</strong> emerges: corporations, legal systems, democracies.<br><br><strong>Universities</strong> become invention accelerators—back-propagating to every technical cluster. Social systems are <em>meta-inventions</em>: inventions that produce inventions.",
                "links": ["→ Corporations", "→ Universities", "→ Markets"],
                "backlinks": ["← Writing", "← Printing"]
            },
            "space": {
                "title": "Space & Scale — Boundary Expansion",
                "body": "<strong>Glass</strong> enables optical instruments: telescope (macro-scale), microscope (micro-scale). Observation drives theory; theory enables <strong>rocketry</strong>.<br><br><strong>Satellites</strong> create the orbital infrastructure layer: GPS, communications, Earth observation. Space becomes the <em>new constraint frontier</em>—energy, radiation, vacuum.",
                "links": ["→ Satellites", "→ GPS", "→ Space Stations"],
                "backlinks": ["← Glass", "← Combustion", "← Materials"]
            },
            "agi": {
                "title": "AGI Hub — Dense Convergence",
                "body": "Not an endpoint—a <strong>hyperdense node</strong> where all chains converge. Requires: <strong>massive compute (energy), precision fabrication (tools), neural architecture insights (biology), algorithmic theory (information)</strong>.<br><br>AGI becomes a <strong>new fire</strong>: a general-purpose enabler spawning unpredictable chains. The constraint envelope: <strong>alignment, energy, interpretability, governance</strong>.",
                "links": ["→ ?", "→ ?", "→ ∞"],
                "backlinks": ["← All Clusters"]
            }
        }
    };

    let currentData = JSON.parse(JSON.stringify(DATA));
    
    const canvas = document.getElementById('network');
    const ctx = canvas.getContext('2d');
    const tooltip = document.getElementById('tooltip');
    const jsonEditor = document.getElementById('json-editor');
    const statusDot = document.getElementById('status-dot');
    const statusText = document.getElementById('status-text');
    const nodeCountEl = document.getElementById('node-count');
    
    let width, height;
    let animating = true;
    let time = 0;
    let mouseX = 0, mouseY = 0;
    let hoveredNode = null;
    let cameraX = 0, cameraY = 0;
    let targetCameraX = 0, targetCameraY = 0;
    let zoom = 1;
    let isDragging = false;
    let dragStartX, dragStartY;
    
    let nodeMap = new Map();
    let processedNodes = [];
    let processedEdges = [];
    
    function processData() {
        processedNodes = currentData.nodes.map(n => ({
            ...n,
            originalX: n.x,
            originalY: n.y,
            vx: 0,
            vy: 0
        }));
        nodeMap = new Map(processedNodes.map(n => [n.id, n]));
        
        processedEdges = currentData.edges.filter(e => 
            nodeMap.has(e.source) && nodeMap.has(e.target)
        );
        
        renderLegend();
        renderClusters();
        nodeCountEl.textContent = `${processedNodes.length} nodes`;
    }
    
    function renderLegend() {
        const legend = document.getElementById('legend');
        legend.innerHTML = '';
        
        Object.entries(currentData.clusters).forEach(([id, cluster]) => {
            const item = document.createElement('div');
            item.className = 'legend-item';
            item.dataset.cluster = id;
            item.innerHTML = `
                <span class="legend-dot" style="color: ${cluster.color}"></span>
                <span>${cluster.label}</span>
            `;
            item.addEventListener('click', () => focusCluster(id));
            legend.appendChild(item);
        });
    }
    
    function renderClusters() {
        const content = document.getElementById('cluster-content');
        content.innerHTML = '';
        
        Object.entries(currentData.descriptions).forEach(([id, desc], i) => {
            const cluster = currentData.clusters[id];
            if (!cluster) return;
            
            const section = document.createElement('div');
            section.className = 'cluster-section';
            section.style.animationDelay = `${i * 0.08}s`;
            
            const links = desc.links?.map(l => `<span class="link-tag">${l}</span>`).join('') || '';
            const backlinks = desc.backlinks?.map(l => `<span class="link-tag backlink">${l}</span>`).join('') || '';
            
            section.innerHTML = `
                <div class="cluster-header">
                    <span class="cluster-dot" style="background: ${cluster.color}; box-shadow: 0 0 10px ${cluster.color}"></span>
                    ${desc.title}
                </div>
                <div class="cluster-body">
                    ${desc.body}
                    <br><br>
                    ${links}${backlinks}
                </div>
            `;
            content.appendChild(section);
        });
    }
    
    function focusCluster(clusterId) {
        const clusterNodes = processedNodes.filter(n => n.cluster === clusterId);
        if (clusterNodes.length === 0) return;
        
        const avgX = clusterNodes.reduce((s, n) => s + n.x, 0) / clusterNodes.length;
        const avgY = clusterNodes.reduce((s, n) => s + n.y, 0) / clusterNodes.length;
        targetCameraX = -avgX * zoom;
        targetCameraY = -avgY * zoom;
    }
    
    function resize() {
        width = window.innerWidth;
        height = window.innerHeight;
        canvas.width = width * devicePixelRatio;
        canvas.height = height * devicePixelRatio;
        canvas.style.width = width + 'px';
        canvas.style.height = height + 'px';
        ctx.scale(devicePixelRatio, devicePixelRatio);
    }
    
    function animate() {
        if (animating) {
            time += 0.006;
            
            processedNodes.forEach(node => {
                const drift = Math.sin(time + node.originalX * 0.01) * 2;
                node.x = node.originalX + drift;
                node.y = node.originalY + Math.cos(time + node.originalY * 0.01) * 2;
            });
        }
        
        cameraX += (targetCameraX - cameraX) * 0.08;
        cameraY += (targetCameraY - cameraY) * 0.08;
        
        ctx.clearRect(0, 0, width, height);
        ctx.save();
        ctx.translate(width / 2 + cameraX, height / 2 + cameraY);
        ctx.scale(zoom, zoom);
        
        processedEdges.forEach(edge => {
            const source = nodeMap.get(edge.source);
            const target = nodeMap.get(edge.target);
            if (!source || !target) return;
            
            const sColor = currentData.clusters[source.cluster]?.color || '#666';
            const tColor = currentData.clusters[target.cluster]?.color || '#666';
            
            const gradient = ctx.createLinearGradient(source.x, source.y, target.x, target.y);
            gradient.addColorStop(0, sColor + '40');
            gradient.addColorStop(1, tColor + '40');
            
            ctx.beginPath();
            ctx.strokeStyle = gradient;
            ctx.lineWidth = edge.type === 'backlink' ? 1.5 : 1;
            
            if (edge.type === 'backlink') {
                ctx.setLineDash([4, 4]);
            } else {
                ctx.setLineDash([]);
            }
            
            const midX = (source.x + target.x) / 2;
            const midY = (source.y + target.y) / 2;
            const offset = Math.sin(time * 2 + source.x * 0.05) * 12;
            
            ctx.moveTo(source.x, source.y);
            ctx.quadraticCurveTo(midX + offset, midY + offset, target.x, target.y);
            ctx.stroke();
            ctx.setLineDash([]);
            
            const pulsePos = (time * 0.25 + edge.source.charCodeAt(0) * 0.1) % 1;
            const pulseX = source.x + (target.x - source.x) * pulsePos;
            const pulseY = source.y + (target.y - source.y) * pulsePos;
            
            ctx.beginPath();
            ctx.arc(pulseX, pulseY, 1.5, 0, Math.PI * 2);
            ctx.fillStyle = sColor + '80';
            ctx.fill();
        });
        
        processedNodes.forEach(node => {
            const isHovered = hoveredNode === node;
            const size = isHovered ? node.size * 1.25 : node.size;
            const color = currentData.clusters[node.cluster]?.color || '#666';
            
            const glowSize = size * 2.5;
            const glow = ctx.createRadialGradient(node.x, node.y, 0, node.x, node.y, glowSize);
            glow.addColorStop(0, color + '25');
            glow.addColorStop(1, 'transparent');
            ctx.beginPath();
            ctx.arc(node.x, node.y, glowSize, 0, Math.PI * 2);
            ctx.fillStyle = glow;
            ctx.fill();
            
            ctx.beginPath();
            ctx.arc(node.x, node.y, size, 0, Math.PI * 2);
            const ng = ctx.createRadialGradient(node.x - size * 0.3, node.y - size * 0.3, 0, node.x, node.y, size);
            ng.addColorStop(0, color);
            ng.addColorStop(1, color + '70');
            ctx.fillStyle = ng;
            ctx.fill();
            
            ctx.strokeStyle = color;
            ctx.lineWidth = isHovered ? 2 : 1;
            ctx.stroke();
            
            if (node.id === 'fire' || node.id === 'agi') {
                for (let i = 0; i < 3; i++) {
                    const phase = (time + i * 0.33) % 1;
                    const ringSize = size + phase * size * 2;
                    const alpha = (1 - phase) * 0.25;
                    ctx.beginPath();
                    ctx.arc(node.x, node.y, ringSize, 0, Math.PI * 2);
                    ctx.strokeStyle = color + Math.floor(alpha * 255).toString(16).padStart(2, '0');
                    ctx.lineWidth = 1;
                    ctx.stroke();
                }
            }
            
            if (isHovered || node.size > 15) {
                ctx.font = `${isHovered ? '11px' : '9px'} 'JetBrains Mono', monospace`;
                ctx.fillStyle = '#e8e6e3';
                ctx.textAlign = 'center';
                ctx.fillText(node.label, node.x, node.y + size + 14);
            }
        });
        
        ctx.restore();
        requestAnimationFrame(animate);
    }
    
    function screenToWorld(sx, sy) {
        return {
            x: (sx - width / 2 - cameraX) / zoom,
            y: (sy - height / 2 - cameraY) / zoom
        };
    }
    
    canvas.addEventListener('mousemove', (e) => {
        mouseX = e.clientX;
        mouseY = e.clientY;
        
        if (isDragging) {
            targetCameraX += e.clientX - dragStartX;
            targetCameraY += e.clientY - dragStartY;
            dragStartX = e.clientX;
            dragStartY = e.clientY;
            return;
        }
        
        const world = screenToWorld(mouseX, mouseY);
        hoveredNode = null;
        
        for (const node of processedNodes) {
            const dx = world.x - node.x;
            const dy = world.y - node.y;
            if (Math.sqrt(dx * dx + dy * dy) < node.size * 1.4) {
                hoveredNode = node;
                break;
            }
        }
        
        if (hoveredNode) {
            canvas.style.cursor = 'pointer';
            tooltip.classList.add('visible');
            tooltip.style.left = (mouseX + 12) + 'px';
            tooltip.style.top = (mouseY + 12) + 'px';
            tooltip.querySelector('.tooltip-title').textContent = hoveredNode.label;
            tooltip.querySelector('.tooltip-meta').textContent = 
                `${currentData.clusters[hoveredNode.cluster]?.label || hoveredNode.cluster} · ${
                    processedEdges.filter(e => e.source === hoveredNode.id || e.target === hoveredNode.id).length
                } connections`;
        } else {
            canvas.style.cursor = 'grab';
            tooltip.classList.remove('visible');
        }
    });
    
    canvas.addEventListener('mousedown', (e) => {
        isDragging = true;
        dragStartX = e.clientX;
        dragStartY = e.clientY;
        canvas.style.cursor = 'grabbing';
    });
    
    canvas.addEventListener('mouseup', () => {
        isDragging = false;
        canvas.style.cursor = hoveredNode ? 'pointer' : 'grab';
    });
    
    canvas.addEventListener('mouseleave', () => {
        isDragging = false;
        tooltip.classList.remove('visible');
    });
    
    canvas.addEventListener('wheel', (e) => {
        e.preventDefault();
        zoom = Math.max(0.25, Math.min(3, zoom * (e.deltaY > 0 ? 0.92 : 1.08)));
    });
    
    document.querySelectorAll('.panel-tab').forEach(tab => {
        tab.addEventListener('click', () => {
            document.querySelectorAll('.panel-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-view').forEach(v => v.classList.remove('active'));
            tab.classList.add('active');
            document.getElementById(`tab-${tab.dataset.tab}`).classList.add('active');
        });
    });
    
    const dataSelect = document.getElementById('data-select');
    
    function loadEditorData() {
        const key = dataSelect.value;
        jsonEditor.value = JSON.stringify(currentData[key], null, 2);
        validateJson();
    }
    
    dataSelect.addEventListener('change', loadEditorData);
    
    jsonEditor.addEventListener('input', validateJson);
    
    function validateJson() {
        try {
            JSON.parse(jsonEditor.value);
            statusDot.classList.remove('error');
            statusText.textContent = 'Valid JSON';
            return true;
        } catch (e) {
            statusDot.classList.add('error');
            statusText.textContent = 'Invalid JSON';
            return false;
        }
    }
    
    document.getElementById('apply-btn').addEventListener('click', () => {
        if (!validateJson()) return;
        
        try {
            const key = dataSelect.value;
            currentData[key] = JSON.parse(jsonEditor.value);
            processData();
        } catch (e) {
            console.error(e);
        }
    });
    
    document.getElementById('reset-btn').addEventListener('click', () => {
        const key = dataSelect.value;
        currentData[key] = JSON.parse(JSON.stringify(DATA[key]));
        loadEditorData();
        processData();
    });
    
    document.getElementById('format-btn').addEventListener('click', () => {
        try {
            const parsed = JSON.parse(jsonEditor.value);
            jsonEditor.value = JSON.stringify(parsed, null, 2);
        } catch (e) {}
    });
    
    document.getElementById('resetView').addEventListener('click', () => {
        targetCameraX = 0;
        targetCameraY = 0;
        zoom = 1;
    });
    
    document.getElementById('toggleAnim').addEventListener('click', (e) => {
        animating = !animating;
        e.target.textContent = animating ? '⏸' : '▶';
    });
    
    document.getElementById('exportData').addEventListener('click', () => {
        const blob = new Blob([JSON.stringify(currentData, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'neuro-chain-data.json';
        a.click();
        URL.revokeObjectURL(url);
    });
    
    window.addEventListener('resize', resize);
    resize();
    processData();
    loadEditorData();
    animate();
    </script>
</body>
</html>
